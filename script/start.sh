#!/bin/bash
echo -e "\033[48;5;235;38;2;0;191;255m           _____                _____                    _____                    _____                _____           \033[0m"; sleep 0.02 
echo -e "\033[48;5;235;38;2;0;191;255m          /\    \              /\    \                  /\    \                  /\    \              /\    \          \033[0m"; sleep 0.02
echo -e "\033[48;5;235;38;2;0;191;255m         /::\    \            /::\    \                /::\    \                /::\    \            /::\    \         \033[0m"; sleep 0.02
echo -e "\033[48;5;235;38;2;0;191;255m        /::::\    \           \:::\    \              /::::\    \              /::::\    \           \:::\    \        \033[0m"; sleep 0.02
echo -e "\033[48;5;235;38;2;0;191;255m       /::::::\    \           \:::\    \            /::::::\    \            /::::::\    \           \:::\    \       \033[0m"; sleep 0.02
echo -e "\033[48;5;235;38;2;0;191;255m      /:::/\:::\    \           \:::\    \          /:::/\:::\    \          /:::/\:::\    \           \:::\    \      \033[0m"; sleep 0.02
echo -e "\033[48;5;235;38;2;0;191;255m     /:::/__\:::\    \           \:::\    \        /:::/__\:::\    \        /:::/__\:::\    \           \:::\    \     \033[0m"; sleep 0.02
echo -e "\033[48;5;235;38;2;0;191;255m     \:::\   \:::\    \          /::::\    \      /::::\   \:::\    \      /::::\   \:::\    \          /::::\    \    \033[0m"; sleep 0.02
echo -e "\033[48;5;235;38;2;0;191;255m   ___\:::\   \:::\    \        /::::::\    \    /::::::\   \:::\    \    /::::::\   \:::\    \        /::::::\    \   \033[0m"; sleep 0.02
echo -e "\033[48;5;235;38;2;0;191;255m  /\   \:::\   \:::\    \      /:::/\:::\    \  /:::/\:::\   \:::\    \  /:::/\:::\   \:::\____\      /:::/\:::\    \  \033[0m"; sleep 0.02
echo -e "\033[48;5;235;38;2;0;191;255m /::\   \:::\   \:::\____\    /:::/  \:::\____\/:::/  \:::\   \:::\____\/:::/  \:::\   \:::|    |    /:::/  \:::\____\ \033[0m"; sleep 0.02
echo -e "\033[48;5;235;38;2;0;191;255m \:::\   \:::\   \::/    /   /:::/    \::/    /\::/    \:::\  /:::/    /\::/   |::::\  /:::|____|   /:::/    \::/    / \033[0m"; sleep 0.02
echo -e "\033[48;5;235;38;2;0;191;255m  \:::\   \:::\   \/____/   /:::/    / \/____/  \/____/ \:::\/:::/    /  \/____|:::::\/:::/    /   /:::/    / \/____/  \033[0m"; sleep 0.02
echo -e "\033[48;5;235;38;2;0;191;255m   \:::\   \:::\    \      /:::/    /                    \::::::/    /         |:::::::::/    /   /:::/    /           \033[0m"; sleep 0.02
echo -e "\033[48;5;235;38;2;0;191;255m    \:::\   \:::\____\    /:::/    /                      \::::/    /          |::|\::::/    /   /:::/    /            \033[0m"; sleep 0.02
echo -e "\033[48;5;235;38;2;0;191;255m     \:::\  /:::/    /    \::/    /                       /:::/    /           |::| \::/____/    \::/    /             \033[0m"; sleep 0.02
echo -e "\033[48;5;235;38;2;0;191;255m      \:::\/:::/    /      \/____/                       /:::/    /            |::|  ~|           \/____/              \033[0m"; sleep 0.02
echo -e "\033[48;5;235;38;2;0;191;255m       \::::::/    /                                    /:::/    /             |::|   |                                \033[0m"; sleep 0.02
echo -e "\033[48;5;235;38;2;0;191;255m        \::::/    /                                    /:::/    /              \::|   |                                \033[0m"; sleep 0.02
echo -e "\033[48;5;235;38;2;0;191;255m         \::/    /                                     \::/    /                \:|   |                                \033[0m"; sleep 0.02
echo -e "\033[48;5;235;38;2;0;191;255m          \/____/                                       \/____/                  \|___|                                \033[0m"; sleep 0.2

# 获取当前目录路径
current_path=$(pwd)

# 获取上一级目录的路径
parent_dir=$(dirname "$current_path")

# 获取上一级目录中的 bin 目录路径
bin_dir="$parent_dir/bin"

# 检查 bin 目录是否存在
if [ ! -d "$bin_dir" ]; then
    echo "上一级目录中不存在 bin 目录。"
    exit 1
fi

# 获取 bin 目录中的文件列表
files=("$bin_dir"/*)

# 检查 bin 目录是否为空
if [ ${#files[@]} -eq 0 ]; then
    echo "bin 目录中没有文件。"
    exit 1
fi

###################

BLUE='\033[1;34m'    # 蓝色用于文件名
YELLOW='\033[1;33m'  # 黄色用于序号
NC='\033[0m'         # 清除颜色

echo -e "请选择要执行的文件:"
for i in "${!files[@]}"; do
    file="${files[$i]##*/}"  # 只获取文件名
    echo -e "${YELLOW}$((i + 1))${NC}) ${BLUE}$file${NC}"
done


while true; do
    read -p "请输入序号: " choice
    
    # 检查输入是否为有效数字，并在范围内
    if [[ "$choice" =~ ^[0-9]+$ ]] && (( choice >= 1 && choice <= ${#files[@]} )); then
        file="${files[choice-1]}"
        
        # 检查是否为可执行文件
        if [[ -x "$file" ]]; then
            echo -e "\033[48;5;235;38;2;0;191;255m 🚀 正在执行 ${BLUE}${file##*/}${NC}... \033[0m"
            "$file"
        else
            echo -e "${BLUE}${file##*/}${NC} 不是可执行文件，是否尝试用 bash 执行？(y/n)"
            read -r run_with_bash
            if [[ "$run_with_bash" == "y" ]]; then
                bash "$file"
            else
                echo "取消执行 ${BLUE}${file##*/}${NC}。"
            fi
        fi
        break
    else
        echo "无效选择，请重新选择。"
    fi
done
